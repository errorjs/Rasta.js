<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
  <title>Rasta.js</title>
  <link rel='stylesheet' href='http://twitter.github.com/bootstrap/assets/css/bootstrap-1.0.0.min.css'>
  <style type='text/css' media='screen'>
    body { margin-top: 0 }
    .masthead { height: 200px; margin-bottom: 20px }
    .footer { height: 50px; margin-top: 20px; }
    .masthead div, .footer div { height: 100%; width: 180px; float:left }
    .row .green { background: #76B524 }
    .row .black { background: #1F0A0A; width: 220px }
    .row .red { background: #DB1F64 }
    .row .gold { background: #F7D53E }
    .menu_space { float: left; width: 90px; height:10px }
    #script-tag .input { margin: 0 }
    #script-tag span { display: inline; padding: 4px 20px; margin-right: 10px }
    .hidden { display: none }
    #tabs { min-height: 330px }
    #plusonebutton { margin-left: 40px; margin-top: 30px; }
  </style>
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6389050-4']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</head>
<body>

<div class='container'>
  <div class='row masthead'>
    <div class='green'></div>
    <div class='black'></div>
    <div class='red'></div>
    <div class='gold'></div>
    <div class='green'></div>
  </div>
  <div class='page-header'>
    <h1>
      Rasta.js
      <small>ACID-less anonymous public cross-domain key-value data store</small>
    </h1>
  </div>
  <div class='row' id='script-tag'>
    <h6>Setup</h6>
    <form>
    <div class='input'>
      <span class='uneditable-input'>
        &lt;script src=&#39;http://rastajs.errorjs.com/rasta.min.js&#39; type=&#39;text/javascript&#39;&gt;&lt;/script&gt;
      </span>
      <object classid='clsid:d27cdb6e-ae6d-11cf-96b8-444553540000' width='110' height='14' id='clippy'>
        <param name='movie' value='/clippy.swf' />
        <param name='allowScriptAccess' value='always' />
        <param name='quality' value='high' />
        <param name='scale' value='noscale' />
        <param NAME='FlashVars' value='text=&lt;script src=&#39;http://rastajs.errorjs.com/rasta.min.js&#39; type=&#39;text/javascript&#39;&gt;&lt;/script&gt;' />
        <param name='bgcolor' value='#FFFFFF'>
        <embed src='/clippy.swf'
          width='110'
          height='14'
          name='clippy'
          quality='high'
          allowScriptAccess='always'
          type='application/x-shockwave-flash'
          pluginspage='http://www.macromedia.com/go/getflashplayer'
          FlashVars='text=&lt;script src=&#39;http://rastajs.errorjs.com/rasta.min.js&#39; type=&#39;text/javascript&#39;&gt;&lt;/script&gt;'
          bgcolor='#FFFFFF'
          />
      </object>
    </div>
    </form>
  </div>

  <div class='row'>
    <div class='span4 columns'>
      <h6>What</h6>
      <h5>Persistent across websites</h5>
      <h5>No security</h5>
      <h5>Under 500 bytes</h5>
      <h5>2 operations: <code>get</code>/<code>set</code></h5>
      <div id="plusonebutton"><g:plusone></g:plusone></div>
    </div>

    <div class='span12 columns' id='tabs'>
      <ul class='tabs'>
        <li class='active'><a href='#' id='get_menu'>GET</a></li>
        <li><a href='#' id='set_menu'>SET</a></li>
        <li><span class='menu_space'></span></li>
        <li><a href='#' id='readme_menu'>README</a></li>
        <li><a href='#' id='why_menu'>WHY?</a></li>
        <li><a href='#' id='faq_menu'>FAQ</a></li>
        <li><span class='menu_space'></span></li>
        <li><a href='#' id='dummy_menu'>FOR DUMMIES</a></li>
      </ul>
      <div id='get_menu_tab'>
        <form id='get_form'>
          <label for='get_key_input'>Enter key:</label>
          <div class='input input-prepend clearfix'>
            <span class='add-on'>key</span>
            <input class='medium' id='get_key_input' name='get_key_input' value='age' size='16' type='text' />
            <a class='btn primary' id='get_submit' href='#'>GET</a>
          </div>
          <pre>
Rasta.get('<span id='get_key'>age</span>', function(val){
  /* val == '<span id='get_val'>100</span>' */
})</pre>
        </form>
      </div>
      <div id='set_menu_tab' class='hidden'>
        <form id='set_form'>
          <label for='set_key_input'>Enter key:</label>
          <div class='input input-prepend clearfix'>
            <span class='add-on'>key</span>
            <input class='medium' id='set_key_input' name='set_key_input' value='age' size='16' type='text' />
          </div>
          <label for='set_val_input'>Enter value:</label>
          <div class='input input-prepend clearfix'>
            <span class='add-on'>val</span>
            <input class='medium' id='set_val_input' name='set_key_input' value='100' size='16' type='text' />
            <a class='btn primary' id='set_submit' href='#'>SET</a>
          </div>
          <pre>
Rasta.set('<span id='set_key'>age</span>','<span id='set_val'>100</span>', function(){
  /* <span id='set_result'>    </span> */
})
          </pre>
        </form>
      </div>
      <div id='readme_menu_tab' class='hidden'>

        <p>
          Keys and values are limited to 250 ASCII characters,
          excluding <code>space</code>, <code>newline</code>, <code>?</code> and <code>/</code>
        </p>

        <p>JSON-P is used for cross-domain communication</p>

        <p>Optional second callback will be called on error</p>
        <pre>
Rasta.get('some_key', function(val){
  /* use val */
}, function(){
  /* error occured */
})</pre>

      </div>

      <div id='why_menu_tab' class='hidden'>
        <p>Data store for static websites</p>
        <p>Communication between front-ends</p>
        <p>A building block</p>
        <p>A simple, easy to implement API (just 2 endpoints):</p>
        <pre>
GET /get/{key}?callback=?
and
GET /set/{key}/{val}?callback=?</pre>
      </div>

      <div id='faq_menu_tab' class='hidden'>
        <h4><i>Where's the data stored?</i></h4>
        <p>By default, my server (well, heroku at the moment). If you want to host your own, just change <code>Rasta.url</code>.</p>
        <h4><i>How much storage?</i></h4>
        <p>Unspecified by design. Let's say 5 MB. Old keys are invalidated. Strategy unspecified, could be LRU, LFU, etc.</p>
        <h4><i>Why HTTP <code>GET</code> for setting?</i></h4>
        <p>Because JSON-P doesn't support POST.</p>
        <small>Message <code>github.com/pitr</code> for more questions</small>
      </div>

      <div id='dummy_menu_tab' class='hidden'>
        <h4>Wait. What's this again?</h4>
        <p>
          This is a key-value date store (something like Memcache or Redis)
          that you can access from browser's front-end (like HTML5
          localStorage), except you do not host it yourself.
        </p>
        <p>
          By simply including provided script tag, you get a tiny library that
          communicates with the data store. You get
          <ol>
            <li><code>Rasta.get(key, cb(), err())</code>,</li>
            <li><code>Rasta.set(key, val, cb(), err())</code>, and</li>
            <li><code>Rasta.url=</code> (initialized to "http://rastajs.errorjs.com")</li>
          </ol>
        </p>
      </div>

    </div>
  </div>

  <div class='row footer'>
    <div class='green'></div>
    <div class='black'></div>
    <div class='red'></div>
    <div class='gold'></div>
    <div class='green'></div>
  </div>

</div>

<a href="http://github.com/errorjs/Rasta.js"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://a248.e.akamai.net/assets.github.com/img/7afbc8b248c68eb468279e8c17986ad46549fb71/687474703a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub"></a>

<script src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js' type='text/javascript' charset='utf-8'></script>
<script src='/rasta.min.js' type='text/javascript' charset='utf-8'></script>
<script type='text/javascript' charset='utf-8'>
  $(function(){
    var $get_key        = $('#get_key'),
        $get_val        = $('#get_val'),
        $get_key_input  = $('#get_key_input'),
        $set_key        = $('#set_key'),
        $set_val        = $('#set_val'),
        $set_key_input  = $('#set_key_input'),
        $set_val_input  = $('#set_val_input'),
        $set_result     = $('#set_result')
    $('a').click(function(){
      var action = $(this).html()
      _gaq.push(['_trackEvent', 'click', action])
    })
    $('.tabs a').click(function(){
      var type = $(this).attr('id')
      $(this)
        .parent() // li
        .addClass('active')
        .siblings().removeClass('active')
        .parent().nextAll() // divs and forms
        .fadeOut()
        .promise().done(function(){
          $('#' + type + '_tab').fadeIn()
        })
      return false
    })
    // GET
    $('#get_key_input').keyup(function(){
      $get_key.html(Rasta.valid($get_key_input.val()))
    })
    $('#get_submit').click(function(){
      $('#get_form').submit()
      return false
    })
    $('#get_form').submit(function(){
      Rasta.get($get_key_input.val(), function(val){
        $get_val.text(val)
      })
      return false
    })
    // SET
    $('#set_key_input').keyup(function(){
      $set_key.html(Rasta.valid($set_key_input.val()))
    })
    $('#set_val_input').keyup(function(){
      $set_val.html(Rasta.valid($set_val_input.val()))
    })
    $('#set_submit').click(function(){
      $('#set_form').submit()
      return false
    })
    $('#set_form').submit(function(){
      $set_result.html('    ')
      Rasta.set($set_key_input.val(), $set_val_input.val(), function(){
        $set_result.html('done').fadeTo('fast', 0.33, function(){$set_result.fadeTo('fast', 1)})
      })
      return false
    })
  })
</script>

<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
</body>
</html>
